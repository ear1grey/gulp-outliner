const PLUGIN_NAME="gulp-toc";var through=require("through2"),jsdom=require("jsdom").jsdom,outliner=require("outliner"),tocdebug=!1;module.exports=function(){return through.obj(function(e,t,o){var r=e.contents.toString(),n=jsdom(r,null,{features:{QuerySelector:!0}});try{var l=n.querySelectorAll("article");if(l.length>0){var u=n.querySelector("head>title"),c=n.querySelector("article section h1");if(c&&u&&""===u.innerHTML){var i=c.innerHTML;tocdebug&&grunt.log.writeln("Title to: "+i),u.innerHTML=i}var g=n.querySelector("#contents");tocdebug&&console.log("Getting handle on Outliner from "+require.resolve("outliner")),outliner.genPop(n,l[0],g),tocdebug&&console.log("crumbs:"+e.path);var s=n.querySelector("#breadcrumbs");s&&(s.innerHTML=outliner.crumb(e.path.split("content/")[1]))}else tocdebug&&console.log(" No article in:"+e.path)}catch(a){tocdebug&&console.log("Ignoring un-outline-able file:"+e.path)}e=e.clone(),e.contents=new Buffer(n.doctype+n.innerHTML),this.push(e),o()})};